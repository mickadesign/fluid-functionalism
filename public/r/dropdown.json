{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "dropdown",
  "title": "Dropdown",
  "description": "Dropdown menu with proximity-based hover tracking, animated selection indicator, and animated focus ring. Includes MenuItem sub-component.",
  "dependencies": [
    "framer-motion"
  ],
  "registryDependencies": [
    "utils",
    "springs",
    "font-weight",
    "shape-context",
    "use-proximity-hover"
  ],
  "files": [
    {
      "path": "registry/default/dropdown.tsx",
      "content": "\"use client\";\n\nimport {\n  useRef,\n  useState,\n  useEffect,\n  createContext,\n  useContext,\n  forwardRef,\n  type ReactNode,\n  type HTMLAttributes,\n} from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\nimport { springs } from \"@/lib/springs\";\nimport { useProximityHover } from \"@/hooks/use-proximity-hover\";\nimport { useShape } from \"@/lib/shape-context\";\n\ninterface DropdownContextValue {\n  registerItem: (index: number, element: HTMLElement | null) => void;\n  activeIndex: number | null;\n  checkedIndex?: number;\n}\n\nconst DropdownContext = createContext<DropdownContextValue | null>(null);\n\nexport function useDropdown() {\n  const ctx = useContext(DropdownContext);\n  if (!ctx) throw new Error(\"useDropdown must be used within a Dropdown\");\n  return ctx;\n}\n\ninterface DropdownProps extends HTMLAttributes<HTMLDivElement> {\n  children: ReactNode;\n  checkedIndex?: number;\n}\n\nconst Dropdown = forwardRef<HTMLDivElement, DropdownProps>(\n  ({ children, checkedIndex, className, ...props }, ref) => {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const {\n      activeIndex,\n      setActiveIndex,\n      itemRects,\n      sessionRef,\n      handlers,\n      registerItem,\n      measureItems,\n    } = useProximityHover(containerRef);\n\n    useEffect(() => {\n      measureItems();\n    }, [measureItems, children]);\n\n    const [focusedIndex, setFocusedIndex] = useState<number | null>(null);\n\n    const activeRect = activeIndex !== null ? itemRects[activeIndex] : null;\n    const checkedRect =\n      checkedIndex != null ? itemRects[checkedIndex] : null;\n    const focusRect = focusedIndex !== null ? itemRects[focusedIndex] : null;\n    const isHoveringOther =\n      activeIndex !== null && activeIndex !== checkedIndex;\n    const shape = useShape();\n\n    return (\n      <DropdownContext.Provider value={{ registerItem, activeIndex, checkedIndex }}>\n        <div\n          ref={(node) => {\n            (containerRef as React.MutableRefObject<HTMLDivElement | null>).current = node;\n            if (typeof ref === \"function\") ref(node);\n            else if (ref) (ref as React.MutableRefObject<HTMLDivElement | null>).current = node;\n          }}\n          onMouseEnter={handlers.onMouseEnter}\n          onMouseMove={handlers.onMouseMove}\n          onMouseLeave={handlers.onMouseLeave}\n          onFocus={(e) => {\n            const indexAttr = (e.target as HTMLElement)\n              .closest(\"[data-proximity-index]\")\n              ?.getAttribute(\"data-proximity-index\");\n            if (indexAttr != null) {\n              const idx = Number(indexAttr);\n              setActiveIndex(idx);\n              setFocusedIndex(\n                (e.target as HTMLElement).matches(\":focus-visible\") ? idx : null\n              );\n            }\n          }}\n          onBlur={(e) => {\n            if (containerRef.current?.contains(e.relatedTarget as Node)) return;\n            setFocusedIndex(null);\n            setActiveIndex(null);\n          }}\n          onKeyDown={(e) => {\n            const items = Array.from(\n              containerRef.current?.querySelectorAll('[role=\"menuitemradio\"]') ?? []\n            ) as HTMLElement[];\n            const currentIdx = items.indexOf(e.target as HTMLElement);\n            if (currentIdx === -1) return;\n\n            if ([\"ArrowDown\", \"ArrowUp\", \"ArrowRight\", \"ArrowLeft\"].includes(e.key)) {\n              e.preventDefault();\n              const next = [\"ArrowDown\", \"ArrowRight\"].includes(e.key)\n                ? (currentIdx + 1) % items.length\n                : (currentIdx - 1 + items.length) % items.length;\n              items[next].focus();\n            } else if (e.key === \"Home\") {\n              e.preventDefault();\n              items[0]?.focus();\n            } else if (e.key === \"End\") {\n              e.preventDefault();\n              items[items.length - 1]?.focus();\n            }\n          }}\n          role=\"menu\"\n          className={cn(\n            `relative flex flex-col gap-0.5 w-72 max-w-full ${shape.container} bg-card shadow-[0_4px_12px_rgba(0,0,0,0.02)] dark:shadow-[0_8px_32px_rgba(0,0,0,0.5)] border border-border/60 p-1 select-none`,\n            className\n          )}\n          {...props}\n        >\n          {/* Selected background */}\n          <AnimatePresence>\n            {checkedRect && (\n              <motion.div\n                className={`absolute ${shape.bg} bg-selected/50 dark:bg-accent/40 pointer-events-none`}\n                initial={false}\n                animate={{\n                  top: checkedRect.top,\n                  left: checkedRect.left,\n                  width: checkedRect.width,\n                  height: checkedRect.height,\n                  opacity: isHoveringOther ? 0.8 : 1,\n                }}\n                exit={{ opacity: 0, transition: { duration: 0.12 } }}\n                transition={{\n                  ...springs.moderate,\n                  opacity: { duration: 0.16 },\n                }}\n              />\n            )}\n          </AnimatePresence>\n\n          {/* Hover background */}\n          <AnimatePresence>\n            {activeRect && (\n              <motion.div\n                key={sessionRef.current}\n                className={`absolute ${shape.bg} bg-accent/40 dark:bg-accent/25 pointer-events-none`}\n                initial={{\n                  opacity: 0,\n                  top: checkedRect?.top ?? activeRect.top,\n                  left: checkedRect?.left ?? activeRect.left,\n                  width: checkedRect?.width ?? activeRect.width,\n                  height: checkedRect?.height ?? activeRect.height,\n                }}\n                animate={{\n                  opacity: 1,\n                  top: activeRect.top,\n                  left: activeRect.left,\n                  width: activeRect.width,\n                  height: activeRect.height,\n                }}\n                exit={{ opacity: 0, transition: { duration: 0.12 } }}\n                transition={{\n                  ...springs.moderate,\n                  opacity: { duration: 0.16 },\n                }}\n              />\n            )}\n          </AnimatePresence>\n\n          {/* Focus ring */}\n          <AnimatePresence>\n            {focusRect && (\n              <motion.div\n                className={`absolute ${shape.focusRing} pointer-events-none z-20 border border-[#6B97FF]`}\n                initial={false}\n                animate={{\n                  left: focusRect.left - 2,\n                  top: focusRect.top - 2,\n                  width: focusRect.width + 4,\n                  height: focusRect.height + 4,\n                }}\n                exit={{ opacity: 0, transition: { duration: 0.12 } }}\n                transition={{\n                  ...springs.moderate,\n                  opacity: { duration: 0.16 },\n                }}\n              />\n            )}\n          </AnimatePresence>\n\n          {children}\n        </div>\n      </DropdownContext.Provider>\n    );\n  }\n);\n\nDropdown.displayName = \"Dropdown\";\n\nexport { Dropdown };\nexport default Dropdown;\n",
      "type": "registry:ui"
    },
    {
      "path": "registry/default/menu-item.tsx",
      "content": "\"use client\";\n\nimport { useRef, useEffect, forwardRef, type HTMLAttributes } from \"react\";\nimport type { LucideIcon } from \"lucide-react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useDropdown } from \"@/components/ui/dropdown\";\nimport { cn } from \"@/lib/utils\";\nimport { fontWeights } from \"@/lib/font-weight\";\nimport { useShape } from \"@/lib/shape-context\";\n\ninterface MenuItemProps extends HTMLAttributes<HTMLDivElement> {\n  icon: LucideIcon;\n  label: string;\n  index: number;\n  checked?: boolean;\n  onSelect?: () => void;\n}\n\nconst MenuItem = forwardRef<HTMLDivElement, MenuItemProps>(\n  (\n    { icon: Icon, label, index, checked, onSelect, className, ...props },\n    ref\n  ) => {\n    const internalRef = useRef<HTMLDivElement>(null);\n    const hasMounted = useRef(false);\n    const { registerItem, activeIndex, checkedIndex } = useDropdown();\n\n    useEffect(() => {\n      registerItem(index, internalRef.current);\n      return () => registerItem(index, null);\n    }, [index, registerItem]);\n\n    useEffect(() => {\n      hasMounted.current = true;\n    }, []);\n\n    const isActive = activeIndex === index;\n    const skipAnimation = !hasMounted.current;\n    const shape = useShape();\n\n    return (\n      <div\n        ref={(node) => {\n          (internalRef as React.MutableRefObject<HTMLDivElement | null>).current = node;\n          if (typeof ref === \"function\") ref(node);\n          else if (ref) (ref as React.MutableRefObject<HTMLDivElement | null>).current = node;\n        }}\n        data-proximity-index={index}\n        tabIndex={index === (checkedIndex ?? 0) ? 0 : -1}\n        role=\"menuitemradio\"\n        aria-checked={!!checked}\n        aria-label={label}\n        onClick={onSelect}\n        onKeyDown={(e) => {\n          if (e.key === \" \" || e.key === \"Enter\") {\n            e.preventDefault();\n            onSelect?.();\n          }\n        }}\n        className={cn(\n          `relative z-10 flex items-center gap-2 ${shape.item} px-2 py-2 cursor-pointer outline-none`,\n          className\n        )}\n        {...props}\n      >\n        <span className=\"inline-grid\">\n          <span className=\"col-start-1 row-start-1 invisible\">\n            <Icon size={16} strokeWidth={2} />\n          </span>\n          <Icon\n            size={16}\n            strokeWidth={isActive || checked ? 2 : 1.5}\n            className={cn(\n              \"col-start-1 row-start-1 transition-[color,stroke-width] duration-80\",\n              isActive || checked\n                ? \"text-foreground\"\n                : \"text-muted-foreground\"\n            )}\n          />\n        </span>\n        <span className=\"inline-grid flex-1 text-[13px]\">\n          <span\n            className=\"col-start-1 row-start-1 invisible\"\n            style={{ fontVariationSettings: fontWeights.semibold }}\n            aria-hidden=\"true\"\n          >\n            {label}\n          </span>\n          <span\n            className={cn(\n              \"col-start-1 row-start-1 transition-[color,font-variation-settings] duration-80\",\n              isActive || checked\n                ? \"text-foreground\"\n                : \"text-muted-foreground\"\n            )}\n            style={{\n              fontVariationSettings: checked\n                ? fontWeights.semibold\n                : fontWeights.normal,\n            }}\n          >\n            {label}\n          </span>\n        </span>\n        <AnimatePresence>\n          {checked && (\n            <motion.svg\n              key=\"check\"\n              width={16}\n              height={16}\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth={2}\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              className=\"text-foreground shrink-0\"\n              initial={{ opacity: 1 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 1 }}\n            >\n              <motion.path\n                d=\"M4 12L9 17L20 6\"\n                initial={{ pathLength: skipAnimation ? 1 : 0 }}\n                animate={{\n                  pathLength: 1,\n                  transition: { duration: 0.08, ease: \"easeOut\" },\n                }}\n                exit={{\n                  pathLength: 0,\n                  transition: { duration: 0.04, ease: \"easeIn\" },\n                }}\n              />\n            </motion.svg>\n          )}\n        </AnimatePresence>\n      </div>\n    );\n  }\n);\n\nMenuItem.displayName = \"MenuItem\";\n\nexport { MenuItem };\nexport default MenuItem;\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:ui"
}