{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "subtle-tab",
  "title": "Subtle Tab",
  "description": "Horizontal tab navigation with proximity hover, animated pill selection indicator, and fluid font-weight transitions. Supports icons and keyboard navigation.",
  "dependencies": [
    "framer-motion",
    "lucide-react"
  ],
  "registryDependencies": [
    "utils",
    "springs",
    "font-weight",
    "use-proximity-hover"
  ],
  "files": [
    {
      "path": "registry/default/subtle-tab.tsx",
      "content": "\"use client\";\n\nimport {\n  useId,\n  useRef,\n  useState,\n  useCallback,\n  useEffect,\n  createContext,\n  useContext,\n  forwardRef,\n  type ReactNode,\n  type HTMLAttributes,\n} from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport type { LucideIcon } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { springs } from \"@/lib/springs\";\nimport { fontWeights } from \"@/lib/font-weight\";\nimport { useProximityHover } from \"@/hooks/use-proximity-hover\";\n\ninterface SubtleTabContextValue {\n  registerTab: (index: number, element: HTMLElement | null) => void;\n  hoveredIndex: number | null;\n  selectedIndex: number;\n  onSelect: (index: number) => void;\n  idPrefix: string;\n}\n\nconst SubtleTabContext = createContext<SubtleTabContextValue | null>(null);\n\nfunction useSubtleTab() {\n  const ctx = useContext(SubtleTabContext);\n  if (!ctx) throw new Error(\"useSubtleTab must be used within a SubtleTab\");\n  return ctx;\n}\n\ninterface SubtleTabProps extends Omit<HTMLAttributes<HTMLDivElement>, \"onSelect\"> {\n  children: ReactNode;\n  selectedIndex: number;\n  onSelect: (index: number) => void;\n  idPrefix?: string;\n}\n\nconst SubtleTab = forwardRef<HTMLDivElement, SubtleTabProps>(\n  ({ children, selectedIndex, onSelect, idPrefix: idPrefixProp, className, ...props }, ref) => {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const isMouseInside = useRef(false);\n    const generatedId = useId();\n    const idPrefix = idPrefixProp || generatedId;\n\n    const {\n      activeIndex: hoveredIndex,\n      setActiveIndex: setHoveredIndex,\n      itemRects: tabRects,\n      handlers,\n      registerItem: registerTab,\n      measureItems: measureTabs,\n    } = useProximityHover(containerRef, { axis: \"x\" });\n\n    useEffect(() => {\n      measureTabs();\n    }, [measureTabs, children]);\n\n    // Wrap handlers to track isMouseInside\n    const handleMouseMove = useCallback(\n      (e: React.MouseEvent) => {\n        isMouseInside.current = true;\n        handlers.onMouseMove(e);\n      },\n      [handlers]\n    );\n\n    const handleMouseLeave = useCallback(() => {\n      isMouseInside.current = false;\n      handlers.onMouseLeave();\n    }, [handlers]);\n\n    const [focusedIndex, setFocusedIndex] = useState<number | null>(null);\n\n    const selectedRect = tabRects[selectedIndex];\n    const hoverRect =\n      hoveredIndex !== null ? tabRects[hoveredIndex] : null;\n    const focusRect = focusedIndex !== null ? tabRects[focusedIndex] : null;\n    const isHoveringSelected = hoveredIndex === selectedIndex;\n    const isHovering = hoveredIndex !== null && !isHoveringSelected;\n\n    return (\n      <SubtleTabContext.Provider\n        value={{ registerTab, hoveredIndex, selectedIndex, onSelect, idPrefix }}\n      >\n        <div\n          ref={(node) => {\n            (containerRef as React.MutableRefObject<HTMLDivElement | null>).current = node;\n            if (typeof ref === \"function\") ref(node);\n            else if (ref) (ref as React.MutableRefObject<HTMLDivElement | null>).current = node;\n          }}\n          onMouseMove={handleMouseMove}\n          onMouseLeave={handleMouseLeave}\n          onFocus={(e) => {\n            const indexAttr = (e.target as HTMLElement)\n              .closest(\"[data-proximity-index]\")\n              ?.getAttribute(\"data-proximity-index\");\n            if (indexAttr != null) {\n              const idx = Number(indexAttr);\n              setHoveredIndex(idx);\n              setFocusedIndex(\n                (e.target as HTMLElement).matches(\":focus-visible\") ? idx : null\n              );\n            }\n          }}\n          onBlur={(e) => {\n            if (containerRef.current?.contains(e.relatedTarget as Node)) return;\n            setFocusedIndex(null);\n            if (isMouseInside.current) return;\n            setHoveredIndex(null);\n          }}\n          onKeyDown={(e) => {\n            const items = Array.from(\n              containerRef.current?.querySelectorAll('[role=\"tab\"]') ?? []\n            ) as HTMLElement[];\n            const currentIdx = items.indexOf(e.target as HTMLElement);\n            if (currentIdx === -1) return;\n\n            if ([\"ArrowLeft\", \"ArrowRight\", \"ArrowUp\", \"ArrowDown\"].includes(e.key)) {\n              e.preventDefault();\n              const next = [\"ArrowRight\", \"ArrowDown\"].includes(e.key)\n                ? (currentIdx + 1) % items.length\n                : (currentIdx - 1 + items.length) % items.length;\n              items[next].focus();\n            } else if (e.key === \"Home\") {\n              e.preventDefault();\n              items[0]?.focus();\n            } else if (e.key === \"End\") {\n              e.preventDefault();\n              items[items.length - 1]?.focus();\n            }\n          }}\n          className={cn(\n            \"relative flex items-center gap-1 select-none overflow-x-auto max-w-full scrollbar-hide px-6 -my-1 py-1\",\n            className\n          )}\n          role=\"tablist\"\n          {...props}\n        >\n          {/* Selected pill */}\n          {selectedRect && (\n            <motion.div\n              className=\"absolute rounded-full bg-selected/50 dark:bg-accent/40 pointer-events-none\"\n              initial={false}\n              animate={{\n                left: selectedRect.left,\n                width: selectedRect.width,\n                top: selectedRect.top,\n                height: selectedRect.height,\n                opacity: isHovering ? 0.8 : 1,\n              }}\n              transition={{\n                ...springs.moderate,\n                opacity: { duration: 0.16 },\n              }}\n            />\n          )}\n\n          {/* Hover pill */}\n          <AnimatePresence>\n            {hoverRect && !isHoveringSelected && selectedRect && (\n              <motion.div\n                className=\"absolute rounded-full bg-accent/60 dark:bg-accent/30 pointer-events-none\"\n                initial={{\n                  left: selectedRect.left,\n                  width: selectedRect.width,\n                  top: selectedRect.top,\n                  height: selectedRect.height,\n                  opacity: 0,\n                }}\n                animate={{\n                  left: hoverRect.left,\n                  width: hoverRect.width,\n                  top: hoverRect.top,\n                  height: hoverRect.height,\n                  opacity: 0.4,\n                }}\n                exit={\n                  !isMouseInside.current && selectedRect\n                    ? {\n                        left: selectedRect.left,\n                        width: selectedRect.width,\n                        top: selectedRect.top,\n                        height: selectedRect.height,\n                        opacity: 0,\n                        transition: { ...springs.moderate, opacity: { duration: 0.12 } },\n                      }\n                    : { opacity: 0, transition: { duration: 0.12 } }\n                }\n                transition={{\n                  ...springs.moderate,\n                  opacity: { duration: 0.16 },\n                }}\n              />\n            )}\n          </AnimatePresence>\n\n          {/* Focus ring */}\n          <AnimatePresence>\n            {focusRect && (\n              <motion.div\n                className=\"absolute rounded-full pointer-events-none z-20 border border-[#6B97FF]\"\n                initial={false}\n                animate={{\n                  left: focusRect.left - 2,\n                  top: focusRect.top - 2,\n                  width: focusRect.width + 4,\n                  height: focusRect.height + 4,\n                }}\n                exit={{ opacity: 0, transition: { duration: 0.12 } }}\n                transition={{\n                  ...springs.moderate,\n                  opacity: { duration: 0.16 },\n                }}\n              />\n            )}\n          </AnimatePresence>\n\n          {children}\n        </div>\n      </SubtleTabContext.Provider>\n    );\n  }\n);\n\nSubtleTab.displayName = \"SubtleTab\";\n\ninterface SubtleTabItemProps extends HTMLAttributes<HTMLButtonElement> {\n  icon: LucideIcon;\n  label: string;\n  index: number;\n}\n\nconst SubtleTabItem = forwardRef<HTMLButtonElement, SubtleTabItemProps>(\n  ({ icon: Icon, label, index, className, ...props }, ref) => {\n    const internalRef = useRef<HTMLButtonElement>(null);\n    const { registerTab, hoveredIndex, selectedIndex, onSelect, idPrefix } =\n      useSubtleTab();\n\n    useEffect(() => {\n      registerTab(index, internalRef.current);\n      return () => registerTab(index, null);\n    }, [index, registerTab]);\n\n    const isActive = hoveredIndex === index || selectedIndex === index;\n\n    return (\n      <button\n        ref={(node) => {\n          (internalRef as React.MutableRefObject<HTMLButtonElement | null>).current = node;\n          if (typeof ref === \"function\") ref(node);\n          else if (ref) (ref as React.MutableRefObject<HTMLButtonElement | null>).current = node;\n        }}\n        data-proximity-index={index}\n        id={`${idPrefix}-tab-${index}`}\n        role=\"tab\"\n        aria-selected={selectedIndex === index}\n        aria-controls={`${idPrefix}-panel-${index}`}\n        tabIndex={selectedIndex === index ? 0 : -1}\n        onClick={() => onSelect(index)}\n        className={cn(\n          \"relative z-10 flex items-center gap-2 rounded-full px-3 py-2 cursor-pointer bg-transparent border-none outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <Icon\n          size={16}\n          strokeWidth={isActive ? 2 : 1.5}\n          className={cn(\n            \"transition-[color,stroke-width] duration-80\",\n            isActive ? \"text-foreground\" : \"text-muted-foreground\"\n          )}\n        />\n        <span className=\"inline-grid text-[13px] whitespace-nowrap\">\n          <span\n            className=\"col-start-1 row-start-1 invisible\"\n            style={{ fontVariationSettings: fontWeights.semibold }}\n            aria-hidden=\"true\"\n          >\n            {label}\n          </span>\n          <span\n            className={cn(\n              \"col-start-1 row-start-1 transition-[color,font-variation-settings] duration-80\",\n              isActive ? \"text-foreground\" : \"text-muted-foreground\"\n            )}\n            style={{\n              fontVariationSettings:\n                selectedIndex === index\n                  ? fontWeights.semibold\n                  : fontWeights.normal,\n            }}\n          >\n            {label}\n          </span>\n        </span>\n      </button>\n    );\n  }\n);\n\nSubtleTabItem.displayName = \"SubtleTabItem\";\n\ninterface SubtleTabPanelProps extends HTMLAttributes<HTMLDivElement> {\n  index: number;\n  selectedIndex: number;\n  idPrefix: string;\n  children: ReactNode;\n}\n\nconst SubtleTabPanel = forwardRef<HTMLDivElement, SubtleTabPanelProps>(\n  ({ index, selectedIndex, idPrefix, children, className, ...props }, ref) => {\n    const isSelected = selectedIndex === index;\n\n    return (\n      <div\n        ref={ref}\n        id={`${idPrefix}-panel-${index}`}\n        role=\"tabpanel\"\n        aria-labelledby={`${idPrefix}-tab-${index}`}\n        hidden={!isSelected}\n        tabIndex={-1}\n        className={cn(\"outline-none\", className)}\n        {...props}\n      >\n        {isSelected && children}\n      </div>\n    );\n  }\n);\n\nSubtleTabPanel.displayName = \"SubtleTabPanel\";\n\nexport { SubtleTab, SubtleTabItem, SubtleTabPanel };\nexport default SubtleTab;\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:ui"
}